import os
import os.path as osp
import pandas as pd
from sklearn.metrics import confusion_matrix
import numpy as np


def load_train_info(train_labels_fp):
    data = pd.read_csv(train_labels_fp)
    train_info = []
    for v in data.values:
        filename, label = v
        train_info.append((filename, label))
    return train_info
        

def create_folder(fold_path):
    if not osp.exists(fold_path):
        os.makedirs(fold_path)


def gen_malware_conf_mat(predict, gt):
    labels = ['Ramnit', 'Lollipop', 'Kelihos_ver3', 'Vundo', 'Simda', 'Tracur', 'Kelihos_ver1', 'Obfuscator.ACY', 'Gatak']
    predict = [labels[i] for i in predict]
    gt = [labels[i] for i in gt]
    return confusion_matrix(gt, predict, labels=labels), labels



