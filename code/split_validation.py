import os
import os.path as osp
from data_loader import *
from utils import *


if __name__ == '__main__':
    data_path = osp.join(os.getcwd(), '..', 'train', 'data', 'resnet50')
    combined_data_path = osp.join(os.getcwd(), '..', 'train', 'data', 'resnet50')
    validation_path = osp.join(os.getcwd(), '..', 'val')
    create_folder(validation_path)
    data = DataLoader(1000, data_path, combined_data_path)
    x_val = []
    y_val = []
    cnt = 0
    while cnt < data.cnt_val:
        x, y = data.next_val()
        x_val += [*x]
        y_val += [*y]
        cnt += len(y)
    x_val = np.asarray(x_val)
    x_val = x_val.ravel().reshape(x_val.shape)
    y_val = np.asarray(y_val)
    np.save(osp.join(validation_path, 'x_val.npy'), x_val)
    np.save(osp.join(validation_path, 'y_val.npy'), y_val)
